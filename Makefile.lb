include $(WORKSPACE_TOP)/common/Makefile.env

NDCTL_UTIL_INSTALL_DIR ?= $(shell component-tool localpath --repo=ndctl --type=$(BUILD_TYPE) ndctl)

NDCTL_DIR := $(WORKSPACE_TOP)/ndctl/

all: build

build:
	cd $(NDCTL_DIR) && ./autogen.sh
	cd $(NDCTL_DIR) && ./configure CFLAGS='-g -O0' --prefix=$(NDCTL_UTIL_INSTALL_DIR) --disable-docs --sysconfdir=/etc --with-bash=no
	$(Q)$(MAKE)

install:
	$(Q)$(MAKE) DESTDIR=$(NDCTL_UTIL_INSTALL_DIR) install

checkin:
	$(Q)component-tool checkin --repo=ndctl --type=$(BUILD_TYPE) ndctl

clean:
	$(Q)$(MAKE) clean

.PHONY: build install checkin clean
